/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_15_puzzle"]("main",{

/***/ "./src/renderer/renderer.tsx":
/*!***********************************!*\
  !*** ./src/renderer/renderer.tsx ***!
  \***********************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"FifteenPuzzleRenderer\": function() { return /* binding */ FifteenPuzzleRenderer; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils */ \"./src/utils/index.ts\");\n/* harmony import */ var _renderer_scss__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./renderer.scss */ \"./src/renderer/renderer.scss\");\n/* harmony import */ var _renderer_scss__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_renderer_scss__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _puzzle_manager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../puzzle-manager */ \"./src/puzzle-manager/index.ts\");\n/* harmony import */ var _utils_use_canvas__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/use-canvas */ \"./src/utils/use-canvas.ts\");\n/* harmony import */ var _utils_use_state_ref__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/use-state-ref */ \"./src/utils/use-state-ref.ts\");\n/* harmony import */ var _15_puzzle_dist_vec2__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! 15-puzzle/dist/vec2 */ \"./node_modules/15-puzzle/dist/vec2.js\");\n\n\n\n\n\n\n\nconst CANVAS_WIDTH = 320;\nconst CANVAS_HEIGHT = 80;\nconst CANVAS_SCALE = 4;\nfunction getSolveTime(puzzle, time) {\n    if (puzzle.isSolved) {\n        return puzzle.timeSolved - puzzle.timeStarted;\n    }\n    else if (puzzle.isSolving) {\n        return time - puzzle.timeStarted;\n    }\n    else\n        return 0;\n}\nfunction fixDigit(number, integerDigit, decimalDigit) {\n    return [\n        String(Math.floor(number)).padStart(integerDigit, \"0\"),\n        String(Math.round(number % 1 * Math.pow(10, decimalDigit))).padEnd(decimalDigit, \"0\"),\n    ];\n}\nfunction parseTime(time, splitters = [1000]) {\n    time = Math.round(time);\n    return splitters\n        .map(splitter => {\n        const i = time % splitter;\n        time /= splitter;\n        return i;\n    })\n        .concat(time)\n        .map(Math.floor);\n}\nfunction FifteenPuzzleRenderer() {\n    const keyMap = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)({\n        4: [0, 0], 5: [1, 0], 6: [2, 0], 7: [3, 0],\n        r: [0, 1], t: [1, 1], y: [2, 1], u: [3, 1],\n        f: [0, 2], g: [1, 2], h: [2, 2], j: [3, 2],\n        v: [0, 3], b: [1, 3], n: [2, 3], m: [3, 3],\n    });\n    const forceUpdate = (0,_utils__WEBPACK_IMPORTED_MODULE_1__.useForceUpdate)();\n    const [isConfirming, setConfirming] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const sizeRef = (0,_utils_use_state_ref__WEBPACK_IMPORTED_MODULE_5__.useStateRef)(new _15_puzzle_dist_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(6, 6));\n    const puzzleManager = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => new _puzzle_manager__WEBPACK_IMPORTED_MODULE_3__.PuzzleManager().on(\"update\", forceUpdate).new(...sizeRef.current), []);\n    const puzzle = puzzleManager.current;\n    const { width, height } = puzzle;\n    const isMouseDown = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    const touchEndFlag = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    const swipeLock = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(false);\n    const reset = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        puzzleManager.new(...sizeRef.current);\n        swipeLock.current = true;\n    }, []);\n    const tryToReset = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(() => {\n        if (!puzzle.isSolving || puzzle.isSolved)\n            return void setConfirming(false), reset();\n        if (!isConfirming)\n            return void setConfirming(true);\n        setConfirming(false);\n        reset();\n    }, [puzzle, isConfirming, reset]);\n    const tap = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((x, y, tapSource) => {\n        if (puzzle.isSolved && puzzle[y][x].toVec2().equalTo(new _15_puzzle_dist_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(puzzle.width - 1, puzzle.height - 1)) && !(tapSource === \"touch-swipe\" || tapSource === \"mouse-swipe\")) {\n            tryToReset();\n        }\n        else {\n            const result = puzzleManager.tap(x, y);\n            if (result)\n                setConfirming(false);\n        }\n    }, [puzzleManager, tryToReset]);\n    (0,_utils__WEBPACK_IMPORTED_MODULE_1__.useKeydown)(document, ({ key }) => {\n        if (key == \" \")\n            tryToReset();\n        const point = keyMap.current[key.toLowerCase()];\n        //@ts-ignore\n        if (Array.isArray(point))\n            tap(...point, \"keyboard\");\n    }, [tap]);\n    const [FPS, setFPS] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(30);\n    (0,_utils__WEBPACK_IMPORTED_MODULE_1__.defineOnGlobal)({ puzzleManager, forceUpdate, sizeRef, keyMap, FPS, setFPS });\n    const ref = (0,_utils_use_canvas__WEBPACK_IMPORTED_MODULE_4__.useCanvas)((ctx, time) => {\n        var _a, _b, _c;\n        ctx.save();\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.scale(ctx.canvas.width / CANVAS_WIDTH, ctx.canvas.height / CANVAS_HEIGHT);\n        const distance = (a, b) => {\n            const v = a.add(b.mul(-1));\n            return Math.abs(v.x) + Math.abs(v.y);\n        };\n        const solveTime = getSolveTime(puzzle, time);\n        const [ms, s] = parseTime(solveTime, [1000]).map(String);\n        const taps = ((_a = puzzle.taps) === null || _a === void 0 ? void 0 : _a.length) || 0;\n        const moves = ((_c = (_b = puzzle.taps) === null || _b === void 0 ? void 0 : _b.reduce(([prevTap, prevCount], tap) => [new _15_puzzle_dist_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(tap.x, tap.y), prevCount + distance(prevTap, new _15_puzzle_dist_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(tap.x, tap.y))], [_puzzle_manager__WEBPACK_IMPORTED_MODULE_3__.Puzzle.generateRandom(puzzle.seed).getPiece(0).toVec2(), 0])) === null || _c === void 0 ? void 0 : _c[1]) || 0;\n        const [tps_int, tps_dec] = fixDigit(taps * 1000 / solveTime || 0, 2, 2);\n        const [mps_int, mps_dec] = fixDigit(moves * 1000 / solveTime || 0, 2, 2);\n        ctx.fillStyle = `#ffffff${puzzle.isSolved ? \"f\" : \"b\"}f`;\n        ctx.font = \"20px 'Roboto Mono'\";\n        ctx.fillText(String(taps), 260 - (20 * 43 / 72) / 2 * (String(taps).length), 32);\n        ctx.fillText(String(moves), 60 - (20 * 43 / 72) / 2 * (String(moves).length), 32);\n        ctx.fillText(String(tps_int), 260 - 2 - (20 * 43 / 72) * (String(tps_int).length), 52);\n        ctx.fillText(String(tps_dec), 260 + 2 + (20 * 43 / 72) * (String(tps_dec).length - 2), 52);\n        ctx.fillText(String(mps_int), 60 - 2 - (20 * 43 / 72) * (String(mps_int).length), 52);\n        ctx.fillText(String(mps_dec), 60 + 2 + (20 * 43 / 72) * (String(mps_dec).length - 2), 52);\n        ctx.fillStyle = \"#ffffff\";\n        ctx.font = \"36px 'Roboto Mono'\";\n        ctx.fillText(s.padStart(2, \"0\"), 160 - 5.5 - (36 * 43 / 72) * Math.max(2, s.length), 48);\n        ctx.font = \"24px 'Roboto Mono'\";\n        ctx.fillText(ms.padStart(3, \"0\"), 160 + 6, 48);\n        ctx.beginPath();\n        ctx.ellipse(60, 52, 1.0, 1.0, 0, 0, 360);\n        ctx.closePath();\n        ctx.ellipse(160, 48, 1.5, 1.5, 0, 0, 360);\n        ctx.closePath();\n        ctx.ellipse(260, 52, 1.0, 1.0, 0, 0, 360);\n        ctx.closePath();\n        ctx.fill();\n        ctx.restore();\n    }, [puzzle], FPS);\n    const toVec2 = (index, width) => new _15_puzzle_dist_vec2__WEBPACK_IMPORTED_MODULE_6__.Vec2(index % puzzle.width, Math.floor(index / puzzle.width));\n    return react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react__WEBPACK_IMPORTED_MODULE_0___default().Fragment), null,\n        react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { style: { \"--columns\": width, \"--rows\": height }, className: (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().fifteenPuzzleRenderer) },\n            react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"canvas\", { className: (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().timerCanvas), ref: ref, width: CANVAS_WIDTH * CANVAS_SCALE, height: CANVAS_HEIGHT * CANVAS_SCALE }),\n            puzzle.in1d.sort((p1, p2) => p1.id - p2.id).map(piece => (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { style: { \"--x\": piece.x, \"--y\": piece.y }, className: (0,_utils__WEBPACK_IMPORTED_MODULE_1__.joinClassNames)((_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().piece), piece.isCorrect() && (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().correct), piece.id === 0 && !puzzle.isSolved && (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().hidden)) },\n                react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().content) }, piece.id || \"R\")))),\n            react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().tapListeners), \"aria-hidden\": true }, (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => (0,_utils__WEBPACK_IMPORTED_MODULE_1__.range)(puzzle.width * puzzle.height)\n                .map(i => toVec2(i, puzzle.width))\n                .map(([x, y], i) => (react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", { className: (_renderer_scss__WEBPACK_IMPORTED_MODULE_2___default().listener), key: i, \"data-index\": i, style: { '--x': x, '--y': y }, onMouseDown: () => {\n                    isMouseDown.current = true;\n                    if (touchEndFlag.current) {\n                        touchEndFlag.current = false;\n                        return;\n                    }\n                    tap(x, y, \"mouse-click\");\n                }, onMouseMove: () => { if (isMouseDown.current)\n                    tap(x, y, \"mouse-swipe\"); }, onMouseUp: () => { isMouseDown.current = false; }, onTouchStart: () => {\n                    swipeLock.current = false;\n                    tap(x, y, \"touch-tap\");\n                }, onTouchMove: ({ changedTouches: touches }) => {\n                    if (swipeLock.current)\n                        return;\n                    const touch = touches.item(0);\n                    const element = document.elementFromPoint(touch.clientX, touch.clientY);\n                    const [x, y] = toVec2(+element.dataset.index, width);\n                    tap(x, y, \"touch-swipe\");\n                }, onTouchEnd: () => { touchEndFlag.current = true; } }))), [puzzle]))));\n}\n\n\n//# sourceURL=webpack://15-puzzle/./src/renderer/renderer.tsx?");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ "use strict";
/******/ 
/******/ /* webpack/runtime/getFullHash */
/******/ !function() {
/******/ 	__webpack_require__.h = function() { return "26156a45e74141acbc09"; }
/******/ }();
/******/ 
/******/ }
);